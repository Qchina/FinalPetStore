{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      isLoggedIn: false,\n      keyword: '',\n      showDropdown: false,\n      items: [{\n        id: 'FISH',\n        name: 'Fish',\n        type: 'category'\n      }, {\n        id: 'DOGS',\n        name: 'Dogs',\n        type: 'category'\n      }, {\n        id: 'CATS',\n        name: 'Cats',\n        type: 'category'\n      }, {\n        id: 'REPTILES',\n        name: 'Reptiles',\n        type: 'category'\n      }, {\n        id: 'BIRDS',\n        name: 'Birds',\n        type: 'category'\n      }, {\n        id: 'FI-SW-01',\n        name: 'Angelfish',\n        category: 'Fish',\n        type: 'product'\n      }, {\n        id: 'FI-SW-02',\n        name: 'Tiger Shark',\n        category: 'Fish',\n        type: 'product'\n      }, {\n        id: 'FI-FW-01',\n        name: 'Koi',\n        category: 'Fish',\n        type: 'product'\n      }, {\n        id: 'FI-FW-02',\n        name: 'Goldfish',\n        category: 'Fish',\n        type: 'product'\n      }, {\n        id: 'EST-1',\n        name: 'Angelfish',\n        category: 'Fish',\n        type: 'product'\n      }, {\n        id: 'EST-2',\n        name: 'Tiger Shark',\n        category: 'Fish',\n        type: 'product'\n      }\n      // 可以继续添加更多产品...\n      ]\n    };\n  },\n  computed: {\n    filteredItems() {\n      if (!this.keyword) return [];\n      const searchTerm = this.keyword.toLowerCase();\n      return this.items.filter(item => item.id.toLowerCase().includes(searchTerm) || item.name.toLowerCase().includes(searchTerm)).slice(0, 8); // 最多显示8个建议\n    }\n  },\n  created() {\n    // 页面加载时判断是否已登录\n    const user = localStorage.getItem('user');\n    this.isLoggedIn = !!user;\n  },\n  methods: {\n    async logout() {\n      try {\n        // 调用后端登出接口\n        await axios.post('http://localhost:9090/api/v1/accounts/logout', {}, {\n          withCredentials: true\n        });\n        localStorage.removeItem('user');\n        this.isLoggedIn = false;\n        this.$router.push('/');\n      } catch (error) {\n        console.error('登出失败:', error);\n      }\n    },\n    handleInput() {\n      this.showDropdown = true;\n    },\n    handleBlur() {\n      // 延迟关闭下拉框，确保可以点击选项\n      setTimeout(() => {\n        this.showDropdown = false;\n      }, 200);\n    },\n    selectItem(item) {\n      this.keyword = item.name;\n      this.showDropdown = false;\n      if (item.type === 'category') {\n        this.$router.push(`/commodity/${item.name}`);\n      } else if (item.type === 'product') {\n        this.$router.push(`/commodity/${item.category}/product/${item.id}`);\n      }\n    },\n    search() {\n      if (!this.keyword) return;\n\n      // 先检查是否匹配具体商品ID\n      const productMatch = this.items.find(item => item.id.toLowerCase() === this.keyword.toLowerCase() && item.type === 'product');\n      if (productMatch) {\n        this.$router.push(`/commodity/${productMatch.category}/product/${productMatch.id}`);\n        return;\n      }\n\n      // 再检查是否匹配分类\n      const categoryMatch = this.items.find(item => item.name.toLowerCase() === this.keyword.toLowerCase() && item.type === 'category');\n      if (categoryMatch) {\n        this.$router.push(`/commodity/${categoryMatch.id}`);\n        return;\n      }\n\n      // 如果都不匹配，进入搜索结果页\n      this.$router.push({\n        path: '/search',\n        query: {\n          keyword: this.keyword\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","data","isLoggedIn","keyword","showDropdown","items","id","name","type","category","computed","filteredItems","searchTerm","toLowerCase","filter","item","includes","slice","created","user","localStorage","getItem","methods","logout","post","withCredentials","removeItem","$router","push","error","console","handleInput","handleBlur","setTimeout","selectItem","search","productMatch","find","categoryMatch","path","query"],"sources":["D:\\ournewpetstore\\src\\components\\CommonTop.vue"],"sourcesContent":["<template>\r\n  <div id=\"Header\">\r\n    <div id=\"Logo\">\r\n      <div id=\"LogoContent\">\r\n        <router-link to=\"/\"><img src=\"@/assets/images/logo-topbar.gif\"></router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <div id=\"Menu\">\r\n      <div id=\"MenuContent\">\r\n        <router-link to=\"/cart\"><img align=\"middle\" name=\"img_cart\" src=\"@/assets/images/cart.gif\" /></router-link>\r\n        <img align=\"middle\" src=\"@/assets/images/separator.gif\" />\r\n        \r\n        <template v-if=\"!isLoggedIn\">\r\n          <router-link to=\"/userauth\">Sign In</router-link>\r\n          <img align=\"middle\" src=\"@/assets/images/separator.gif\" />\r\n        </template>\r\n        \r\n        <template v-else>\r\n          <a href=\"#\" @click.prevent=\"logout\">Sign Out</a>\r\n          <img align=\"middle\" src=\"@/assets/images/separator.gif\" />\r\n          <router-link to=\"/accountauth\">My Account</router-link>\r\n          <img align=\"middle\" src=\"@/assets/images/separator.gif\" />\r\n        </template>\r\n        \r\n        <router-link to=\"/help\">?</router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <div id=\"Search\">\r\n      <div id=\"SearchContent\">\r\n        <form @submit.prevent=\"search\">\r\n          <input \r\n            type=\"text\" \r\n            v-model=\"keyword\" \r\n            @input=\"handleInput\"\r\n            @focus=\"showDropdown = true\"\r\n            @blur=\"handleBlur\"\r\n            size=\"14\" \r\n            id=\"keyword\" \r\n            placeholder=\"Search pets or products...\"\r\n          >\r\n          <input type=\"submit\" value=\"Search\">\r\n        </form>\r\n        <div id=\"productAutoComplete\" v-show=\"showDropdown && filteredItems.length\">\r\n          <ul id=\"productAutoList\">\r\n            <li \r\n              v-for=\"item in filteredItems\" \r\n              :key=\"item.id\"\r\n              @mousedown=\"selectItem(item)\"\r\n              class=\"auto-complete-item\"\r\n            >\r\n              <span class=\"item-name\">{{ item.name }}</span>\r\n              <span class=\"item-category\" v-if=\"item.category\">({{ item.category }})</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div id=\"TextLinks\">\r\n      <router-link to=\"/commodity/Fish\" class=\"text-link\">Fish</router-link>\r\n      <img src=\"@/assets/images/separator.gif\" />\r\n      <router-link to=\"/commodity/Dogs\" class=\"text-link\">Dogs</router-link>\r\n      <img src=\"@/assets/images/separator.gif\" />\r\n      <router-link to=\"/commodity/Reptiles\" class=\"text-link\">Reptiles</router-link>\r\n      <img src=\"@/assets/images/separator.gif\" />\r\n      <router-link to=\"/commodity/Cats\" class=\"text-link\">Cats</router-link>\r\n      <img src=\"@/assets/images/separator.gif\" />\r\n      <router-link to=\"/commodity/Birds\" class=\"text-link\">Birds</router-link>\r\n    </div> \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nexport default {\r\n  data() {\r\n    return {\r\n      isLoggedIn: false,\r\n      keyword: '',\r\n      showDropdown: false,\r\n      items: [\r\n        { id: 'FISH', name: 'Fish', type: 'category' },\r\n        { id: 'DOGS', name: 'Dogs', type: 'category' },\r\n        { id: 'CATS', name: 'Cats', type: 'category' },\r\n        { id: 'REPTILES', name: 'Reptiles', type: 'category' },\r\n        { id: 'BIRDS', name: 'Birds', type: 'category' },\r\n        { id: 'FI-SW-01', name: 'Angelfish', category: 'Fish', type: 'product' },\r\n        { id: 'FI-SW-02', name: 'Tiger Shark', category: 'Fish', type: 'product' },\r\n        { id: 'FI-FW-01', name: 'Koi', category: 'Fish', type: 'product' },\r\n        { id: 'FI-FW-02', name: 'Goldfish', category: 'Fish', type: 'product' },\r\n        { id: 'EST-1', name: 'Angelfish', category: 'Fish', type: 'product' },\r\n        { id: 'EST-2', name: 'Tiger Shark', category: 'Fish', type: 'product' },\r\n        // 可以继续添加更多产品...\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    filteredItems() {\r\n      if (!this.keyword) return [];\r\n      const searchTerm = this.keyword.toLowerCase();\r\n      return this.items.filter(item => \r\n        item.id.toLowerCase().includes(searchTerm) ||\r\n        item.name.toLowerCase().includes(searchTerm)\r\n      ).slice(0, 8); // 最多显示8个建议\r\n    }\r\n  },\r\n  created() {\r\n    // 页面加载时判断是否已登录\r\n    const user = localStorage.getItem('user');\r\n    this.isLoggedIn = !!user;\r\n  },\r\n  methods: {\r\n    async logout() {\r\n      try {\r\n        // 调用后端登出接口\r\n        await axios.post('http://localhost:9090/api/v1/accounts/logout', {}, { withCredentials: true });\r\n        localStorage.removeItem('user');\r\n        this.isLoggedIn = false;\r\n        this.$router.push('/');\r\n      } catch (error) {\r\n        console.error('登出失败:', error);\r\n      }\r\n    },\r\n    handleInput() {\r\n      this.showDropdown = true;\r\n    },\r\n    handleBlur() {\r\n      // 延迟关闭下拉框，确保可以点击选项\r\n      setTimeout(() => {\r\n        this.showDropdown = false;\r\n      }, 200);\r\n    },\r\n    selectItem(item) {\r\n      this.keyword = item.name;\r\n      this.showDropdown = false;\r\n      if (item.type === 'category') {\r\n        this.$router.push(`/commodity/${item.name}`);\r\n      } else if (item.type === 'product') {\r\n        this.$router.push(`/commodity/${item.category}/product/${item.id}`);\r\n      }\r\n    },\r\n    search() {\r\n      if (!this.keyword) return;\r\n      \r\n      // 先检查是否匹配具体商品ID\r\n      const productMatch = this.items.find(item => \r\n        item.id.toLowerCase() === this.keyword.toLowerCase() && \r\n        item.type === 'product'\r\n      );\r\n      if (productMatch) {\r\n        this.$router.push(`/commodity/${productMatch.category}/product/${productMatch.id}`);\r\n        return;\r\n      }\r\n\r\n      // 再检查是否匹配分类\r\n      const categoryMatch = this.items.find(item => \r\n        item.name.toLowerCase() === this.keyword.toLowerCase() && \r\n        item.type === 'category'\r\n      );\r\n      if (categoryMatch) {\r\n        this.$router.push(`/commodity/${categoryMatch.id}`);\r\n        return;\r\n      }\r\n\r\n      // 如果都不匹配，进入搜索结果页\r\n      this.$router.push({ \r\n        path: '/search', \r\n        query: { keyword: this.keyword } \r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#Header {\r\n  background-color: black;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0 20px;\r\n  height: 60px;\r\n  position: fixed;\r\n  top:0;\r\n  width: 100%;\r\n  z-index: 1;\r\n}\r\n\r\n#LogoContent {\r\n  margin: 0;\r\n}\r\n\r\n#LogoContent img {\r\n  border: 0;\r\n  height: 40px;\r\n  width: auto;\r\n}\r\n/* 修改文字链接样式 */\r\n#TextLinks {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 10px 0;\r\n  width: auto;\r\n  background-color: transparent;\r\n  border-radius: 0;\r\n}\r\n.text-link {\r\n  color: yellow;\r\n  font-weight: bold;\r\n  text-decoration: none;\r\n  transition: color 0.3s ease;\r\n  font-size: 14px;\r\n}\r\n\r\n.text-link:hover {\r\n  color: #f40;\r\n}\r\n\r\n#TextLinks img {\r\n  border: 0;\r\n  vertical-align: middle;\r\n}\r\n#MenuContent {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n#MenuContent a {\r\n  color: yellow;\r\n  font-weight: bold;\r\n  text-decoration: none;\r\n  transition: color 0.3s ease;\r\n}\r\n\r\n#MenuContent a:hover {\r\n  color: #f40;\r\n}\r\n\r\n#MenuContent img[name=\"img_cart\"] {\r\n  margin-right: 0;\r\n}\r\n\r\n#Search {\r\n  position: static;\r\n  width: auto;\r\n}\r\n\r\n#SearchContent {\r\n  display: flex;\r\n  gap: 5px;\r\n}\r\n\r\n#SearchContent input[type=\"text\"] {\r\n  width: 140px;\r\n  padding: 8px;\r\n  border: 1px solid #ccc;\r\n  background-color: gray;\r\n  color: white;\r\n  border-radius: 4px;\r\n}\r\n\r\n#SearchContent input[type=\"submit\"] {\r\n  padding: 8px 15px;\r\n  background-color: #e0e0e0;\r\n  color: black;\r\n  border: none;\r\n  cursor: pointer;\r\n  border-radius: 4px;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\n#SearchContent input[type=\"submit\"]:hover {\r\n  background-color: #ccc;\r\n}\r\n\r\n#QuickLinks {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 10px 0;\r\n  width: auto;\r\n}\r\n\r\n#QuickLinks img {\r\n  border: 0;\r\n  vertical-align: middle;\r\n  transition: transform 0.3s ease;\r\n}\r\n\r\n#QuickLinks img:hover {\r\n  transform: scale(1.1);\r\n}\r\n\r\n#productAutoComplete {\r\n  position: absolute;\r\n  background: white;\r\n  border: 1px solid #ccc;\r\n  width: 180px;\r\n  z-index: 100;\r\n  border-radius: 4px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n#productAutoList {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\n#productAutoList li {\r\n  padding: 10px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\n#productAutoList li:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n.auto-complete-item {\r\n  padding: 8px 12px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.auto-complete-item:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.item-name {\r\n  font-weight: 500;\r\n}\r\n\r\n.item-category {\r\n  color: #666;\r\n  font-size: 0.9em;\r\n}\r\n\r\n#productAutoComplete {\r\n  position: absolute;\r\n  top: 100%;\r\n  background: white;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  width: 220px;\r\n  max-height: 300px;\r\n  overflow-y: auto;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n}\r\n\r\n#productAutoList {\r\n  margin: 0;\r\n  padding: 0;\r\n  list-style: none;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}